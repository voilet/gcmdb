(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[19],{"0kyw":function(e,t,a){e.exports={"switch-btn-block":"antd-pro-components-access-role-assign-modal-switch-btn-block","table-block":"antd-pro-components-access-role-assign-modal-table-block"}},GPpn:function(e,t,a){"use strict";var s=a("TqRt"),l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var r=s(a("kLXV")),i=s(a("pVnL"));a("+L6B");var d=s(a("2/Rp"));a("/xke");var n=s(a("TeRw"));a("5NDa");var o=s(a("5rEg"));a("y8nQ");var c,h,p,u,f=s(a("Vl3Y")),m=l(a("q1tI")),v=a("MuoO"),g=f.default.Item,b=o.default.TextArea,y=(e,t)=>{n.default[e]({message:"\u901a \u77e5 \u680f",description:t})},w=(c=(0,v.connect)(e=>e),h=f.default.create(),c(p=h((u=class extends m.PureComponent{constructor(){super(...arguments),this.state={modalVisible:!1},this.handleModalVisible=(e=>{var t=this.props.form;t.resetFields(),this.setState({modalVisible:!!e})}),this.handleAdd=(()=>{var e=this.props.form;e.validateFields(e=>{});var t={rolename:e.getFieldValue("rolename")?e.getFieldValue("rolename"):"",remarks:e.getFieldValue("remarks")?e.getFieldValue("remarks"):""};this.props.dispatch({type:"grole/addRole",payload:{description:t,cb:e=>{"200"==e.status?y("success","\u6dfb\u52a0\u89d2\u8272\u6210\u529f!~ ~"):y("error","\u6dfb\u52a0\u89d2\u8272\u5931\u8d25!~ ~")}}}),this.setState({modalVisible:!1}),e.resetFields()})}render(){var e=this.props.form.getFieldDecorator,t={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:12},md:{span:10}}};return m.default.createElement("div",null,m.default.createElement(d.default,{type:"primary",icon:"plus",onClick:()=>this.handleModalVisible(!0)},"\u6dfb\u52a0\u89d2\u8272"),m.default.createElement(r.default,{title:"\u6dfb\u52a0\u89d2\u8272",visible:this.state.modalVisible,onOk:this.handleAdd,width:600,onCancel:()=>this.handleModalVisible()},m.default.createElement(g,(0,i.default)({},t,{label:"\u89d2\u8272\u540d"}),e("rolename",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"}]})(m.default.createElement(o.default,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"}))),m.default.createElement(g,(0,i.default)({},t,{label:"\u89d2\u8272\u63cf\u8ff0"}),e("remarks",{rules:[{required:!0,message:"\u89d2\u8272\u63cf\u8ff0"}]})(m.default.createElement(b,{style:{minHeight:32},placeholder:"\u89d2\u8272\u63cf\u8ff0",rows:4})))))}},p=u))||p)||p);t.default=w},"T/Ci":function(e,t,a){e.exports={tableList:"antd-pro-pages-g-power-role-role-list-tableList",tableListOperator:"antd-pro-pages-g-power-role-role-list-tableListOperator",tableListForm:"antd-pro-pages-g-power-role-role-list-tableListForm",submitButtons:"antd-pro-pages-g-power-role-role-list-submitButtons"}},VX2v:function(e,t,a){"use strict";var s=a("TqRt"),l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var r=s(a("bx4M"));a("/zsF");var i=s(a("PArb"));a("14J3");var d=s(a("BMrR"));a("jCWc");var n=s(a("kPKH")),o=s(a("MVZn"));a("y8nQ");var c,h,p,u,f=s(a("Vl3Y")),m=l(a("q1tI")),v=a("MuoO"),g=s(a("T/Ci")),b=s(a("GPpn")),y=s(a("obT9")),w=e=>Object.keys(e).map(t=>e[t]).join(","),I=(c=(0,v.connect)(e=>e),h=f.default.create(),c(p=h((u=class extends m.PureComponent{constructor(){super(...arguments),this.state={expandForm:!1,selectedRows:[],formValues:{}},this.handleStandardTableChange=((e,t,a)=>{var s=this.props.dispatch,l=this.state.formValues,r=Object.keys(t).reduce((e,a)=>{var s=(0,o.default)({},e);return s[a]=w(t[a]),s},{}),i=(0,o.default)({currentPage:e.current,pageSize:e.pageSize},l,r);a.field&&(i.sorter=`${a.field}_${a.order}`),s({type:"gproline/getProjectList",payload:i})}),this.handleRefreshTableChange=(()=>{var e=this.props.dispatch;e({type:"gproline/getProjectLine",payload:""})}),this.handleFormReset=(()=>{var e=this.props,t=e.form,a=e.dispatch;t.resetFields(),this.setState({formValues:{}}),a({type:"gproline/getProjectList",payload:{}})}),this.toggleForm=(()=>{this.setState({expandForm:!this.state.expandForm})}),this.handleSelectRows=(e=>{this.setState({selectedRows:e})}),this.handleSaveData=(e=>{var t=e.ID,a=e.title,s={ID:t,title:a};this.props.dispatch({type:"grole/modifyRole",payload:{description:s,cb:e=>{"200"==e.status?openNotificationWithIcon("success","\u5206\u914d\u6743\u9650\u6210\u529f!~ ~"):openNotificationWithIcon("error","\u5206\u914d\u6743\u9650\u5931\u8d25!~ ~")}}})}),this.handleDeleteData=(e=>{var t=e.ID,a={},s=[];s.push(t),a.ids=s,this.props.dispatch({type:"gproline/deleteProject",payload:{tag:!1,infolist:JSON.stringify(a)}})})}componentDidMount(){var e=this.props.dispatch;e({type:"grole/getRolelist"})}render(){var e=this.state.selectedRows,t=this.props,a=t.grole,s=t.dispatch;return m.default.createElement(r.default,{bordered:!1},m.default.createElement("div",{className:g.default.tableList},m.default.createElement("div",{className:g.default.tableListOperator},m.default.createElement(d.default,{gutter:16},m.default.createElement(n.default,{span:2}))),m.default.createElement(b.default,{dispatch:this.props.dispatch}),m.default.createElement(i.default,null," \u89d2\u8272\u5217\u8868 "),m.default.createElement(y.default,{selectedRows:e,dispatch:s,handleSaveData:this.handleSaveData,handleDeleteData:this.handleDeleteData,roledata:a.data,assignInfo:a.assignInfo,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange})))}},p=u))||p)||p);t.default=I},fepD:function(e,t,a){"use strict";var s=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var l=s(a("kLXV"));a("g9YV");var r=s(a("wCAj"));a("BoS7");var i=s(a("Sdc0"));a("+L6B");var d=s(a("2/Rp"));a("/xke");var n=s(a("TeRw"));a("+BJd");var o=s(a("mr32")),c=s(a("q1tI")),h=(s(a("17x9")),s(a("0kyw"))),p=[{title:"\u8d44\u6e90\u540d\u79f0",dataIndex:"name",key:"name"},{title:"\u7c7b\u522b",dataIndex:"rtype",key:"rtype",width:"100px",render:(e,t)=>{var a;return console.log("text",e),a=0==e?c.default.createElement(o.default,{color:"#108ee9"},"\u533a\u57df"):1==e?c.default.createElement(o.default,{color:"#009900"},"\u83dc\u5355"):c.default.createElement(o.default,{color:"#944dff"},"\u6309\u94ae"),c.default.createElement("div",null,a)}},{title:"\u5730\u5740",dataIndex:"link_url",width:"30%",key:"link_url"}],u=(e,t)=>{n.default[e]({message:"\u901a \u77e5 \u680f",description:t})};class f extends c.default.Component{constructor(e){super(e),this.getExpandKeys=(e=>{e.forEach(e=>{1===e.has_licence&&this.selectedRowKeys.push(e.ID),e.children&&(this.expandItem.push(e.ID),this.getExpandKeys(e.children))})}),this.getAssingInfo=(e=>{var t=e,a=this.props.dispatch;a({type:"grole/getRoleResource",payload:{roleid:t,cb:e=>{this.getExpandKeys(e.data),this.initExpandItem()}}}),this.setState({visible:!0}),this.params.roleId=t,this.params.resourceIds=this.selectedRowKeys}),this.initExpandItem=(()=>{var e=this.state,t=e.selectedRowKeys,a=e.expandItem;this.expandItem.forEach(e=>{a.push(e)}),this.selectedRowKeys.forEach(e=>{t.push(e)}),this.setState({expandItem:a,selectedRowKeys:t})}),this.submitAssign=(()=>{console.log("\u5206\u914d\u6210\u529f,\u8bf7\u6c42\u53c2\u6570\u4e3a\uff1a");var e=this.props.dispatch;e({type:"grole/allocateRoleResource",payload:{description:this.params,cb:e=>{"200"==e.status?u("success","\u5206\u914d\u6743\u9650\u6210\u529f!~ ~"):u("error","\u5206\u914d\u6743\u9650\u5931\u8d25!~ ~")}}}),this.setState({visible:!0}),this.init()}),this.cancelAssign=(()=>{this.init()}),this.init=(()=>{var e=this.state.selectedRowKeys;this.params={},this.selectedRowKeys=[],this.expandItem=[],e.splice(0,e.length),this.setState({isExpandAll:!0,visible:!1,selectedRowKeys:e,expandItem:[]})}),this.expandSwitch=(e=>{var t=[];this.expandItem.forEach(e=>{t.push(e)}),this.setState({isExpandAll:e,expandItem:e?t:[]})}),this.expandRow=((e,t)=>{var a=this.state.expandItem;if(e)a.push(t.ID);else{var s=a.indexOf(t.ID);a.splice(s,1)}this.setState({expandItem:a,isExpandAll:a.length===this.expandItem.length})}),this.state={isExpandAll:!0,expandItem:[],selectedRowKeys:[],visible:!1},this.expandItem=[],this.selectedRowKeys=[],this.params={},this.rowSelection={onChange:(e,t)=>{var a=t.map(e=>e.ID);this.params.resourceIds=a},onSelect:(e,t,a)=>{var s=this.state.selectedRowKeys;if(t)s.push(e.ID);else{var l=s.indexOf(e.ID);s.splice(l,1)}this.setState({selectedRowKeys:s})},onSelectAll:(e,t,a)=>{var s=this.state.selectedRowKeys;e?a.forEach(e=>{s.push(e.ID)}):s.splice(0,s.length),this.setState({selectedRowKeys:s})},selectedRowKeys:this.state.selectedRowKeys}}render(){var e=this.props,t=e.assignInfo,a=e.record,s=this.state,n=s.expandItem,o=s.isExpandAll,u=s.visible;return c.default.createElement(c.default.Fragment,null,c.default.createElement(d.default,{onClick:()=>this.getAssingInfo(a)},"\u5206\u914d"),c.default.createElement(l.default,{title:"\u9009\u62e9\u8d44\u6e90",visible:u,onOk:this.submitAssign,onCancel:this.cancelAssign,okText:"\u4fdd\u5b58",width:1e3},c.default.createElement("div",{className:h.default["switch-btn-block"]},c.default.createElement(i.default,{checkedChildren:"\u5168\u90e8\u5c55\u5f00",unCheckedChildren:"\u5168\u90e8\u6536\u7f29",checked:o,onChange:this.expandSwitch})),c.default.createElement("div",{className:h.default["table-block"]},c.default.createElement(r.default,{pagination:!1,columns:p,rowSelection:this.rowSelection,dataSource:t.data,expandedRowKeys:n,onExpand:this.expandRow,rowKey:e=>e.ID}))))}}var m=f;t.default=m},iYqO:function(e,t,a){e.exports={activeChart:"antd-pro-components-access-role-index-activeChart",activeChartGrid:"antd-pro-components-access-role-index-activeChartGrid",activeChartLegend:"antd-pro-components-access-role-index-activeChartLegend"}},obT9:function(e,t,a){"use strict";var s=a("284h"),l=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("g9YV");var r=l(a("wCAj"));a("fOrg");var i=l(a("+KLJ"));a("+L6B");var d=l(a("2/Rp"));a("P2fV");var n=l(a("NJEC"));a("/zsF");var o=l(a("PArb"));a("5NDa");var c=l(a("5rEg"));a("2qtc");var h=l(a("kLXV")),p=s(a("q1tI")),u=l(a("iYqO")),f=l(a("fepD")),m=h.default.confirm,v=e=>{var t=e.editable,a=e.value,s=e.onChange;return p.default.createElement("div",null,t?p.default.createElement(c.default,{style:{margin:"-5px 0"},value:a,onChange:e=>s(e.target.value)}):a)};class g extends p.PureComponent{constructor(){super(...arguments),this.state={selectedRowKeys:[],totalCallNo:0,data:[],selectedLine:!1},this.handleRowSelectChange=((e,t)=>{var a=t.reduce((e,t)=>{return e+parseFloat(t.callNo,10)},0);this.props.onSelectRow&&this.props.onSelectRow(t),this.setState({selectedRowKeys:e,totalCallNo:a})}),this.handleTableChange=((e,t,a)=>{this.props.onChange(e,t,a)}),this.cleanSelectedKeys=(()=>{this.handleRowSelectChange([],[])})}static getDerivedStateFromProps(e,t){return e.resource===t.resource?{}:{data:e.roledata}}renderColumns(e,t,a){return p.default.createElement(v,{editable:t.editable,value:e,onChange:e=>this.handleChange(e,t.ID,a)})}edit(e){var t=[...this.state.data],a=t.filter(t=>e===t.ID)[0];a&&(a.editable=!0,this.setState({data:t}))}save(e){var t=[...this.state.data],a=t.filter(t=>e===t.ID)[0];a&&(delete a.editable,this.setState({data:t}),this.props.handleSaveData(a))}cancel(e){var t=[...this.state.data],a=t.filter(t=>e===t.ID)[0];a&&(delete a.editable,this.setState({data:t}))}confirmdelete(e){var t=this.props.dispatch,a=e.ID;m({title:"\u8bf7\u786e\u8ba4",content:"\u60a8\u662f\u5426\u8981\u5220\u9664\u6240\u9009\u7684\u9879\uff1f",okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:()=>{t({type:"grole/deleteRole",payload:{description:{ID:a},cb:e=>{"200"==e.status?openNotificationWithIcon("success","\u5220\u9664\u89d2\u8272\u6210\u529f!~ ~"):openNotificationWithIcon("error","\u5220\u9664\u89d2\u8272\u5931\u8d25!~ ~")}}})}})}handleChange(e,t,a){var s=[...this.state.data],l=s.filter(e=>t===e.ID)[0];l&&(l[a]=e,this.setState({data:s}))}handleRoleValue(e,t,a){var s=[...this.state.data],l=s.filter(e=>t===e.ID)[0];l&&(l[a]=e,this.setState({data:s,disabled:!1}))}canceldelete(e){var t=[...this.state.data],a=t.filter(t=>e===t.ID)[0];a&&(Object.assign(a,this.cacheData.filter(t=>e===t.ID)[0]),delete a.deleteable,this.setState({data:t}))}render(){var e=this.state,t=e.selectedRowKeys,a=(e.totalCallNo,e.data,this.props),s=a.roledata,l=a.assignInfo,c=[{title:"\u89d2\u8272ID",dataIndex:"ID",key:"ID",width:"120px"},{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"title",key:"title",width:"120px",render:(e,t)=>this.renderColumns(e,t,"title")},{title:"\u7528\u6237\u6570",dataIndex:"user_nums",key:"user_nums",width:"150px"},{title:"\u64cd\u4f5c",dataIndex:"operation",key:"operation",width:"200px",render:(e,t)=>{var a=t.editable;t.deleteable;return p.default.createElement("div",{className:"editable-row-operations"},a?p.default.createElement("span",null,p.default.createElement("a",{onClick:()=>this.save(t.ID)},"\u4fdd\u5b58"),p.default.createElement(o.default,{type:"vertical"}),p.default.createElement(n.default,{title:"\u786e\u5b9a\u53d6\u6d88?",onClick:()=>this.cancel(t.ID)},p.default.createElement("a",null,"\u53d6\u6d88"))):p.default.createElement("span",null,p.default.createElement(d.default,{onClick:()=>this.edit(t.ID)},"\u4fee\u6539"),p.default.createElement(o.default,{type:"vertical"})),a?p.default.createElement("span",null):p.default.createElement("span",null,p.default.createElement(d.default,{onClick:()=>this.confirmdelete(t)},"\u5220\u9664"),p.default.createElement("span",null,p.default.createElement(o.default,{type:"vertical"}),p.default.createElement(f.default,{record:t.ID,assignInfo:l,dispatch:this.props.dispatch}))))}}],h={showSizeChanger:!0,showQuickJumper:!0},m={selectedRowKeys:t,onChange:this.handleRowSelectChange,getCheckboxProps:e=>({disabled:e.disabled})};return p.default.createElement("div",{className:u.default.standardTable},p.default.createElement("div",{className:u.default.tableAlert},p.default.createElement(i.default,{message:p.default.createElement("div",null,"\u5df2\u9009\u62e9 ",p.default.createElement("a",{style:{fontWeight:600}},t.length)," \u4e2a\u7528\u6237\xa0",p.default.createElement("a",{onClick:this.cleanSelectedKeys,style:{marginLeft:24}},"\u53d6\u6d88\u52fe\u9009")),type:"info",showIcon:!0})),p.default.createElement(r.default,{rowKey:e=>e.ID,rowSelection:m,dataSource:s,columns:c,pagination:h,onChange:this.handleTableChange}))}}var b=g;t.default=b}}]);