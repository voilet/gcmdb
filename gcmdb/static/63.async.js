(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[63],{uq5t:function(e,t,a){"use strict";var l=a("TqRt"),d=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var i=l(a("bx4M"));a("g9YV");var n=l(a("wCAj"));a("/zsF");var r=l(a("PArb"));a("giR+");var u=l(a("fyUT")),c=l(a("pVnL"));a("5NDa");var s=l(a("5rEg"));a("14J3");var f=l(a("BMrR"));a("jCWc");var o=l(a("kPKH"));a("P2fV");var h=l(a("NJEC"));a("+L6B");var m=l(a("2/Rp"));a("BoS7");var p=l(a("Sdc0"));a("Pwec");var y=l(a("CtXQ")),b=l(a("MVZn"));a("y8nQ");var E=l(a("Vl3Y"));a("OaEy");var g,v,k,w,S,C=l(a("2fM7")),I=d(a("q1tI")),x=l(a("TXgB")),D=l(a("Y+p1")),V=a("7DNP"),_=a("MuoO"),F=C.default.Option,B=E.default.Item,q=0,P=(g=(0,_.connect)(e=>e),v=E.default.create(),g(k=v((w=class extends I.PureComponent{constructor(){super(...arguments),this.state={modalVisible:!1,disabled:!0,cabinetdata:[],baydata:[],idc:[],haspower:!1,addable:!1,baystatus:!1},this.handleSubmit=(e=>{var t=this.props,a=t.dispatch,l=t.location,d=this.props.form,i=this.state.baydata;e.preventDefault(),d.validateFields((e,t)=>{if(!e){var n={title:d.getFieldValue("title")?d.getFieldValue("title"):"",power:d.getFieldValue("power")?d.getFieldValue("power"):"",idcid:d.getFieldValue("idcid")?d.getFieldValue("idcid"):"",cableport:d.getFieldValue("cableport")?d.getFieldValue("cableport"):"",capacity:d.getFieldValue("capacity")?d.getFieldValue("capacity"):"",status:this.state.haspower?"1":"0",bay_details:JSON.stringify(i)};a({type:"gidc/modifyCabinet",payload:{ID:l.query.id,description:n}})}})}),this.handleAdd=(()=>{console.log("uuid",S);var e=this.state.baydata,t={ID:++S,bay_name:"bay"+q++,host_ip:"\u7a7a (\u65e0\u6cd5\u76f4\u63a5\u4fee\u6539,\u8bf7\u5728\u4e3b\u673a\u5217\u8868\u5173\u8054\u4fee\u6539)",host_sn:"\u7a7a",height:"2U",height_id:2,status:!1,checked:!1};this.setState({baydata:[...e,t],addable:!0})}),this.handleStatusChange=(e=>{this.setState({haspower:e})}),this.handleBayStatusChange=((e,t,a)=>{var l=[...this.state.baydata],d=l.filter(e=>t===e.ID)[0];d&&(d[a]=e,this.setState({data:l}))}),this.handleSelectLineValue=((e,t,a)=>{var l=[...this.state.baydata],d=l.filter(e=>t===e.ID)[0];d&&(d[a]=e,this.setState({data:l}))}),this.confirmDelete=(e=>{var t=[...this.state.baydata],a=t.filter(t=>e===t.ID)[0];if(a){var l=t.indexOf(a);l>-1&&t.splice(l,1),a.tag=!1,this.setState({baydata:t}),this.cacheData=t.map(e=>(0,b.default)({},e))}}),this.confirmSave=(e=>{var t=[...this.state.baydata],a=t.filter(t=>e===t.ID)[0];a&&(a["checked"]=!0,this.setState({data:t}),this.cacheData=t.map(e=>(0,b.default)({},e)))}),this.reback=(()=>{var e=this.props.dispatch;e({type:"gidc/empty"}),e(V.routerRedux.push({pathname:"/resource/idc/cabinet/list"}))}),this.handleSelectChange=(e=>{console.log("value",e),this.props.form.setFieldsValue({idcid:e})})}componentWillMount(){var e=this.props,t=e.dispatch,a=e.location;void 0!==a.query&&(t({type:"gidc/queryCabinetDetail",payload:a.query.id}),t({type:"gidc/queryIDC"}),S=this.props.gidc.cabinetdetail.bay_max_id+1)}componentWillReceiveProps(e){(0,D.default)(e.gidc.cabinetdetail.time4Update,this.props.gidc.cabinetdetail.time4Update)||e.gidc.cabinetdetail&&(0==e.gidc.cabinetdetail.status&&this.setState({haspower:!0}),e.gidc.cabinetdetail.bay_details&&this.setState({baydata:e.gidc.cabinetdetail.bay_details.map(e=>{return e.checked=!0,e})}),this.setState({cabinetdata:e.gidc.cabinetdetail,idc:e.gidc.idc.data}))}handleChange(e,t,a){var l=[...this.state.data],d=l.filter(e=>t===e.ID)[0];d&&(d[a]=e,this.setState({data:l}))}render(){var e=this.state.cabinetdata,t=this.props.form.getFieldDecorator,a={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},l=[{title:"\u673a\u67b6\u540d\u79f0",dataIndex:"bay_name",width:"100px",editable:!0},{title:"\u673a\u67b6\u9ad8\u5ea6",dataIndex:"height",width:"50px",render:(e,t)=>{return I.default.createElement(C.default,{defaultValue:e,disabled:t.selectStatus,style:{width:"150px"},onChange:e=>this.handleSelectLineValue(e,t.ID,"height_id")},I.default.createElement(F,{key:"1",value:"1"},"1U"),I.default.createElement(F,{key:"2",value:"2"},"2U"),I.default.createElement(F,{key:"3",value:"3"},"4U"),I.default.createElement(F,{key:"4",value:"4"},"8U"))}},{title:"\u670d\u52a1\u5668IP",dataIndex:"host_ip",width:"100px",render:(e,t)=>{var a=t.host_ip,l={color:"red"};return I.default.createElement("div",{style:l},a)}},{title:"\u670d\u52a1\u5668\u5e8f\u5217\u53f7",dataIndex:"host_sn",width:"100px",render:(e,t)=>{var a=t.host_sn,l={color:"red"};return I.default.createElement("div",{style:l},a)}},{title:"\u72b6\u6001",dataIndex:"checked",width:"50px",render:(e,t)=>{return t.checked?I.default.createElement(y.default,{type:"check",style:{fontSize:16,color:"#228B22"}}):I.default.createElement(y.default,{type:"close",style:{fontSize:16,color:"#FF0000"}})}},{title:"\u673a\u67b6\u7a7a\u95f2\u72b6\u6001",dataIndex:"status",width:"50px",render:(e,t)=>{var a=t.status;return console.log(a),I.default.createElement("div",null,I.default.createElement(p.default,{checkedChildren:"\u5360\u7528",unCheckedChildren:"\u7a7a\u95f2",checked:a,onChange:e=>this.handleBayStatusChange(e,t.ID,"status")}))}},{title:"\u64cd\u4f5c",dataIndex:"ID",key:"ID",className:`${x.default.tableOperation}`,width:"200px",render:(e,t)=>{return I.default.createElement("div",{className:"editable-row-operations"},I.default.createElement("span",{style:{marginLeft:20}},I.default.createElement("a",{onClick:()=>this.confirmSave(t.ID)},I.default.createElement(m.default,null,"\u4fdd\u5b58"))),I.default.createElement("span",null,I.default.createElement(h.default,{title:"\u786e\u5b9a\u5220\u9664?",onConfirm:()=>this.confirmDelete(t.ID)},I.default.createElement("a",{style:{marginLeft:20}},I.default.createElement(m.default,{type:"danger"},"\u5220\u9664")))))}}];return I.default.createElement(i.default,{bordered:!1},I.default.createElement(f.default,{gutter:24,style:{marginBottom:32}},I.default.createElement(o.default,{span:24,key:2,style:{display:"block",fontSize:20}},"\u673a\u67dc\u4fe1\u606f")),I.default.createElement(E.default,{className:"ant-advanced-search-form",onSubmit:this.handleSubmit},I.default.createElement(f.default,{gutter:24},I.default.createElement(o.default,{span:12},I.default.createElement(B,(0,c.default)({label:"\u673a\u67dc\u540d\u79f0"},a),t("title",{initialValue:`${e.cabinet_name?e.cabinet_name:""}`})(I.default.createElement(s.default,null)))),I.default.createElement(o.default,{span:12},I.default.createElement(B,(0,c.default)({label:"\u673a\u67dc\u7535\u91cf"},a),t("power",{initialValue:`${e.power?e.power:""}`})(I.default.createElement(s.default,null))))),I.default.createElement(f.default,{gutter:24},I.default.createElement(o.default,{span:12},I.default.createElement(B,(0,c.default)({label:"\u6240\u5c5e\u673a\u623f"},a),t("idcid",{initialValue:`${e.idcname?e.idcname:""}`})(I.default.createElement(C.default,{style:{width:264},onChange:this.handleSelectChange},this.state.idc.map((e,t)=>{return I.default.createElement(F,{key:t,value:e.ID},e.idc_name)}))))),I.default.createElement(o.default,{span:12},I.default.createElement(B,(0,c.default)({label:"\u7f51\u53e3\u6570"},a),t("cableport",{initialValue:`${e.cableport?e.cableport:""}`})(I.default.createElement(u.default,{min:1,max:100}))))),I.default.createElement(f.default,{gutter:24},I.default.createElement(o.default,{span:12},I.default.createElement(B,(0,c.default)({label:"\u673a\u67dc\u5bb9\u91cf"},a),t("capacity",{initialValue:`${e.capacity?e.capacity:""}`})(I.default.createElement(u.default,{min:1,max:100})))),I.default.createElement(o.default,{span:12},I.default.createElement(B,(0,c.default)({label:"\u673a\u67dc\u72b6\u6001"},a),I.default.createElement(p.default,{checkedChildren:"\u901a\u7535",unCheckedChildren:"\u672a\u901a\u7535",checked:this.state.haspower,onChange:e=>this.handleStatusChange(e)})))),I.default.createElement(f.default,{gutter:24},I.default.createElement(o.default,{span:12},I.default.createElement(B,(0,c.default)({label:"\u7a7a\u95f2\u673a\u67b6"},a))),I.default.createElement(o.default,{span:12},I.default.createElement(B,(0,c.default)({label:"\u7a7a\u95f2\u7f51\u53e3"},a)))),I.default.createElement(r.default,{style:{marginBottom:32}}),I.default.createElement(f.default,{gutter:24,style:{marginBottom:32}},I.default.createElement(o.default,{span:24,key:2,style:{display:"block",fontSize:20}},"\u673a\u67b6\u4fe1\u606f")),I.default.createElement(f.default,{gutter:24,style:{marginBottom:32}},I.default.createElement(o.default,{span:24,key:2,style:{display:"block"}},I.default.createElement(m.default,{type:"danger",onClick:this.handleAdd,style:{width:"15%"}},I.default.createElement(y.default,{type:"plus-square"})," \u6dfb\u52a0\u673a\u67b6"))),I.default.createElement(f.default,null,I.default.createElement(n.default,{rowKey:e=>e.ID,style:{marginBottom:24},bordered:!0,dataSource:this.state.baydata,columns:l})),I.default.createElement(f.default,{gutter:24,style:{marginBottom:32}},I.default.createElement(o.default,{span:24,style:{textAlign:"left"}},I.default.createElement(m.default,{type:"primary",htmlType:"submit"},"\u63d0\u4ea4"),I.default.createElement(r.default,{type:"vertical"}),I.default.createElement(m.default,{onClick:()=>this.reback()},"\u8fd4\u56de")))))}},k=w))||k)||k);t.default=P}}]);