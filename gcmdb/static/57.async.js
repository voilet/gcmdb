(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[57],{C4GF:function(e,t,a){"use strict";var l=a("TqRt"),d=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var u=l(a("bx4M"));a("+L6B");var i=l(a("2/Rp"));a("giR+");var r=l(a("fyUT"));a("iQDF");var s=l(a("+eQT")),n=l(a("pVnL"));a("14J3");var c=l(a("BMrR"));a("jCWc");var f=l(a("kPKH"));a("/zsF");var m=l(a("PArb"));a("miYZ");var o=l(a("tsqr"));a("OaEy");var p=l(a("2fM7"));a("y8nQ");var h=l(a("Vl3Y"));a("Znn+");var g=l(a("ZTPi"));a("5NDa");var E,y,b,V,_=l(a("5rEg")),v=d(a("q1tI")),F=a("7DNP"),D=a("MuoO"),w=(l(a("Y+p1")),l(a("lhe0"))),k=l(a("FHVR")),I=l(a("wd/R")),$=_.default.TextArea,S=g.default.TabPane,C=h.default.Item,q=p.default.Option,P={labelCol:{span:6},wrapperCol:{span:18}},j="YYYY/MM/DD",R=[],Y=(E=(0,D.connect)(e=>e),y=h.default.create(),E(b=y((V=class extends v.Component{constructor(){super(...arguments),this.state={activeKey:"-1",title:"",panes:[],headlist:[],dateStatus:!0,cabinetData:[],idcData:[],BaysData:[],projectlist:[],hostid:0,allprojectids:[],delprojectids:[],haspower:!0},this.handleIdcChange=(e=>{this.props.dispatch({type:"gidc/queryIdcRelation",payload:`?tag=cabinet&id=${e}`}),this.props.form.setFieldsValue({cabinet_id:this.props.gidc.cabinet.data.map(e=>{return e.title})})}),this.handlecabinetChange=(e=>{this.props.dispatch({type:"gidc/queryIdcRelation",payload:`?tag=bays&id=${e}`}),this.props.form.setFieldsValue({bay_id:this.props.gidc.bays.data.map(e=>{return e.title})})}),this.handleProjectLine=(e=>{this.props.dispatch({type:"gproline/getProjectGroupbyId",payload:e})}),this.handleProjectGroup=(e=>{this.props.dispatch({type:"gproline/getProjectbyId",payload:e})}),this.projectRemove=(e=>{var t=this.props.form,a=t.getFieldValue("keys");1!==a.length&&t.setFieldsValue({keys:a.filter(t=>t!==e)})}),this.isInArray=((e,t)=>{for(var a=0;a<e.length;a++)if(t===e[a])return!0;return!1}),this.handleSave=(e=>{e.preventDefault();var t=this.props.form,a=this.state.dateStatus,l=this.props.gdevice;t.validateFields((e,d)=>{if(!e)if(a){if(a){var u={serialnumber:t.getFieldValue("serialnumber")?t.getFieldValue("serialnumber"):"",eth1:t.getFieldValue("eth1")?t.getFieldValue("eth1"):"",eth2:t.getFieldValue("eth2")?t.getFieldValue("eth2"):"",eth3:t.getFieldValue("eth3")?t.getFieldValue("eth3"):"",eth4:t.getFieldValue("eth4")?t.getFieldValue("eth4"):"",fqdn:t.getFieldValue("fqdn")?t.getFieldValue("fqdn"):"",internal_ip:t.getFieldValue("internal_ip")?t.getFieldValue("internal_ip"):"",mac:t.getFieldValue("mac")?t.getFieldValue("mac"):"",switch_port:t.getFieldValue("switch_port")?t.getFieldValue("switch_port"):"",start_guaratee:t.getFieldValue("start_guaratee")?t.getFieldValue("start_guaratee").format("YYYY-MM-DD HH:mm:ss"):"",stop_guaratee:t.getFieldValue("stop_guaratee")?t.getFieldValue("stop_guaratee").format("YYYY-MM-DD HH:mm:ss"):"",hardware_vendor:t.getFieldValue("hardware_vendor")?t.getFieldValue("hardware_vendor"):"",manufacturer:t.getFieldValue("manufacturer")?t.getFieldValue("manufacturer"):"",cpu_model:t.getFieldValue("cpu_model")?t.getFieldValue("cpu_model"):"",cpuarch:t.getFieldValue("cpuarch")?t.getFieldValue("cpuarch"):"",num_cpus:t.getFieldValue("num_cpus")?t.getFieldValue("num_cpus"):"",disk:t.getFieldValue("disk")?t.getFieldValue("disk"):"",assets_number:t.getFieldValue("assets_number")?t.getFieldValue("assets_number"):"",service_code:t.getFieldValue("service_code")?t.getFieldValue("service_code"):"",memory:t.getFieldValue("memory")?t.getFieldValue("memory"):"",osversion:t.getFieldValue("osversion")?t.getFieldValue("osversion"):"",planversion:t.getFieldValue("planversion")?t.getFieldValue("planversion"):"",user_id:t.getFieldValue("user_manger")?t.getFieldValue("user_manger"):"",remarks:t.getFieldValue("remarks")?t.getFieldValue("remarks"):""};switch(t.getFieldValue("business_id")){case"host\u5df2\u4e0a\u7ebf":u.businessid=10;break;case"host\u672a\u4e0b\u7ebf":u.businessid=9;break;case"host\u5df2\u4e0b\u7ebf":u.businessid=4;break;default:u.businessid=t.getFieldValue("business_id")}this.state.haspower?u.statusid=2:u.statusid=3,l.hostdetail.data.idc_title===t.getFieldValue("idc_id")?u.idc_id=l.hostdetail.data.idc_ID:u.idc_id=t.getFieldValue("idc_id"),l.hostdetail.data.cabinet_title===t.getFieldValue("cabinet_id")?u.cabinet_id=l.hostdetail.data.cabinet_ID:u.cabinet_id=t.getFieldValue("cabinet_id"),l.hostdetail.data.bays_title===t.getFieldValue("bay_id")?u.bay_id=l.hostdetail.data.bays_ID:u.bay_id=t.getFieldValue("bay_id"),u.project=Array.from(new Set(R)),this.props.dispatch({type:"gdevice/modifyHost",payload:{id:this.props.location.query.id,description:u,cb:e=>{"200"==e.status?o.default.success("\u4fee\u6539\u6210\u529f"):o.default.error("\u4fee\u6539\u5931\u8d25"),R=[],[]}}})}}else o.default.error("\u7ef4\u4fdd\u65f6\u95f4\u5fc5\u987b\u5927\u4e8e\u8d2d\u4e70\u65f6\u95f4")})}),this.handleSaveProData=((e,t)=>{R=[],t.map(e=>{e.ID>=1e4?R.push(e.project_id):R.push(e.ID)})}),this.handleDeleteProData=((e,t)=>{R=[],t.map(e=>{e.ID>=1e4?R.push(e.project_id):R.push(e.ID)})}),this.HandleSelectHostStatus=(e=>{this.props.form.setFieldsValue({business_id:`${e}`})}),this.handleStatusChange=(e=>{this.setState({haspower:e})}),this.tabcontent=(e=>{var t,a=this.props.form.getFieldDecorator,l=this.props,d=l.gidc,o=l.gdevice,g=l.ghardware;console.log("this.props",this.props.gidc);var E=this.props.gidc.idc.data.map(e=>{return v.default.createElement(q,{key:e.ID,value:e.ID},e.title)});t=0==d.cabinet.data.length?d.cabinet.data.map(e=>{return v.default.createElement(q,{key:"-1",value:"-1"},"\u8bf7\u9009\u62e9")}):(d.cabinet.data||[]).map(e=>{return v.default.createElement(q,{key:e.ID,value:e.ID},e.title)});var y=d.bays.data.map(e=>v.default.createElement(q,{key:e.ID,value:e.ID},e.title)),b=o.user.data.map(e=>{return v.default.createElement(q,{key:e.ID,value:e.ID},e.title)}),V=g.composedata.data.list.map(e=>{return v.default.createElement(q,{key:e.ID,value:e.ID},e.title)});return v.default.createElement(u.default,{bordered:!1},v.default.createElement(h.default,{className:"ant-advanced-search-form",onSubmit:this.handleSave},v.default.createElement(m.default,{style:{marginBottom:32}}),v.default.createElement(c.default,{gutter:24},v.default.createElement(f.default,{span:8},v.default.createElement("span",null,"\u7f51\u7edc\u4fe1\u606f"))),v.default.createElement(c.default,{gutter:24},v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u7f51\u53611:"},P),a("eth1",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165ip\u5730\u5740!"}],initialValue:`${e.eth1}`})(v.default.createElement(_.default,{placeholder:e.eth1})))),v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u7f51\u53612:"},P),a("eth2",{rules:[{message:"\u8bf7\u8f93\u5165ip\u5730\u5740!"}],initialValue:`${e.eth2}`})(v.default.createElement(_.default,{placeholder:e.eth2})))),v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u4e3b\u673a\u540d(fqdn)"},P),a("fqdn",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4e3b\u673a\u540d!"}],initialValue:`${e.fqdn}`})(v.default.createElement(_.default,{placeholder:e.fqdn}))))),v.default.createElement(c.default,{gutter:24},v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u7f51\u53613:"},P),a("eth3",{initialValue:`${e.eth3}`})(v.default.createElement(_.default,{placeholder:e.eth3})))),v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u7f51\u53614:"},P),a("eth4",{initialValue:`${e.eth4}`})(v.default.createElement(_.default,{placeholder:e.eth4})))),v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u8fdc\u7a0b\u63a7\u5236\u5361IP"},P),a("internal_ip",{rules:[{initialValue:`${e.internal_ip}`}]})(v.default.createElement(_.default,{placeholder:e.internal_ip}))))),v.default.createElement(c.default,{gutter:24},v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"MAC\u5730\u5740: "},P),a("mac",{initialValue:`${e.mac}`})(v.default.createElement(_.default,{placeholder:e.mac})))),v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u6240\u5728\u4ea4\u6362\u673a\u7aef\u53e3: "},P),a("switch_port",{initialValue:`${e.switch_port}`})(v.default.createElement(_.default,{placeholder:e.switch_port}))))),v.default.createElement(m.default,{style:{marginBottom:32}}),v.default.createElement(c.default,{gutter:24},v.default.createElement(f.default,{span:8},v.default.createElement("span",null,"\u786c\u4ef6\u4fe1\u606f"))),v.default.createElement(c.default,null,v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u670d\u52a1\u5668\u5e8f\u5217\u53f7"},P),a("serialnumber",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5e8f\u5217\u53f7!"}],initialValue:`${e.serialnumber}`})(v.default.createElement(_.default,{placeholder:"\u8bf7\u8f93\u5165"})))),v.default.createElement(f.default,{span:8,key:1,style:{display:"block"}},v.default.createElement(C,(0,n.default)({label:"\u673a\u5668\u8d2d\u4e70\u65f6\u95f4"},P),a("start_guaratee",{initialValue:(0,I.default)(e.start_guaratee).isBefore("2006-05-16")?(0,I.default)("2018-05-01",j):(0,I.default)(`${e.start_guaratee}`,j)})(v.default.createElement(s.default,{format:j,onChange:this.newDateChange.bind(this)})))),v.default.createElement(f.default,{span:8,key:2,style:{display:"block"}},v.default.createElement(C,(0,n.default)({label:"\u673a\u5668\u6700\u540e\u7ef4\u4fdd"},P),a("stop_guaratee",{initialValue:(0,I.default)(e.start_guaratee).isBefore("2006-05-16")?(0,I.default)("2018-05-02",j):(0,I.default)(`${e.stop_guaratee}`,j)})(v.default.createElement(s.default,{onChange:this.oldDateChange.bind(this)}))))),v.default.createElement(c.default,null,v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u670d\u52a1\u5668\u751f\u4ea7\u5546"},P),a("hardware_vendor",{initialValue:`${e.hardware_vendor}`})(v.default.createElement(_.default,null)))),v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u670d\u52a1\u5668\u578b\u53f7"},P),a("manufacturer",{initialValue:`${e.manufacturer}`})(v.default.createElement(_.default,null)))),v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"CPU \u53c2\u6570"},P),a("cpu_model",{initialValue:`${e.cpu_model}`})(v.default.createElement(_.default,null))))),v.default.createElement(c.default,null,v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"CPU\u67b6\u6784"},P),a("cpuarch",{initialValue:`${e.cpuarch}`})(v.default.createElement(_.default,null)))),v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"CPU\u6838\u6570"},P),a("num_cpus",{initialValue:`${e.num_cpus}`})(v.default.createElement(r.default,null)))),v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u786c\u76d8\u8be6\u60c5"},P),a("disk",{initialValue:`${e.disk}`})(v.default.createElement(_.default,null))))),v.default.createElement(c.default,{gutter:24},v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u8d44\u4ea7\u7f16\u53f7"},P),a("assets_number",{initialValue:`${e.assets_number}`})(v.default.createElement(_.default,null)))),v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u5feb\u901f\u670d\u52a1\u7801"},P),a("service_code",{initialValue:`${e.service_code}`})(v.default.createElement(_.default,null)))),v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u5185\u5b58\u8be6\u60c5"},P),a("memory",{initialValue:`${e.memory}`})(v.default.createElement(_.default,null))))),v.default.createElement(c.default,{gutter:24},v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u673a\u623f\u9009\u62e9"},P),a("idc_id",{rules:[{required:!0,message:"\u8bf7 \u9009\u62e9\u673a\u623f\u9009\u62e9!"}],initialValue:`${e.idc_title}`})(v.default.createElement(p.default,{style:{width:200,marginRight:40},onChange:this.handleIdcChange},E)))),v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u673a\u67dc\u9009\u62e9"},P),a("cabinet_id",{initialValue:`${e.cabinet_title}`})(v.default.createElement(p.default,{style:{width:200,marginRight:40},onChange:this.handlecabinetChange},t)))),v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u673a\u67b6\u9009\u62e9"},P),a("bay_id",{initialValue:`${e.bays_title}`})(v.default.createElement(p.default,{style:{width:200,marginRight:40}},y))))),v.default.createElement(m.default,{style:{marginBottom:32}}),v.default.createElement(c.default,{gutter:24}),v.default.createElement(c.default,null,v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c"},P),a("osversion",{initialValue:`${e.osrelease}`}),e.osrelease))),v.default.createElement(c.default,null,v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u5957\u9910\u4fe1\u606f"},P),a("planversion",{initialValue:`${e.composeplan}`})(v.default.createElement(p.default,{style:{width:200,marginRight:40}},V))))),v.default.createElement(m.default,{style:{marginBottom:32}}),v.default.createElement(c.default,{gutter:24},v.default.createElement(f.default,{span:8},v.default.createElement("span",null,"\u6743\u9650\u4fe1\u606f"))),v.default.createElement(c.default,null,v.default.createElement(f.default,{span:8},v.default.createElement(C,(0,n.default)({label:"\u673a\u5668\u7ba1\u7406\u5458"},P),a("user_manger",{initialValue:`${e.user}`})(v.default.createElement(p.default,{style:{width:200,marginRight:40},size:"default"},b))))),v.default.createElement(m.default,{style:{marginBottom:32}}),v.default.createElement("div",{className:k.default.title},"\u9879\u76ee\u4fe1\u606f"),v.default.createElement(c.default,{gutter:24},v.default.createElement(w.default,{hostid:this.state.hostid,projectlist:this.state.projectlist,dispatch:this.props.dispatch,gproline:this.props.gproline,handleSaveProData:this.handleSaveProData,handleDeleteProData:this.handleDeleteProData})),v.default.createElement(m.default,{style:{marginBottom:32}}),v.default.createElement(c.default,{gutter:24},v.default.createElement(f.default,null,v.default.createElement(C,{label:"\u5907\u6ce8"},a("remarks",{initialValue:`${e.remarks}`})(v.default.createElement($,{style:{minHeight:32},placeholder:"\u5907\u6ce8\u63cf\u8ff0",rows:4}))))),v.default.createElement(c.default,null,v.default.createElement(f.default,{span:24,style:{textAlign:"right"}},v.default.createElement(i.default,{type:"primary",htmlType:"submit"},"\u63d0\u4ea4"),v.default.createElement(m.default,{type:"vertical"}),v.default.createElement(i.default,{onClick:()=>this.reback()},"\u8fd4\u56de")))))}),this.onChange=(e=>{this.setState({activeKey:e})}),this.onEdit=((e,t)=>{this[t](e)}),this.reback=(()=>{var e=this.props,t=e.dispatch,a=(e.match,this.state.activeKey),l=this.state.panes.filter(e=>e.key!==a);this.setState({panes:l}),t(F.routerRedux.push({pathname:"/resource/hardware/host/list"}))}),this.remove=(e=>{var t,a=this.state.activeKey;this.state.panes.forEach((a,l)=>{a.key===e&&(t=l-1)});var l=this.state.panes.filter(t=>t.key!==e);t>=0&&a===e&&(a=l[t].key),this.setState({panes:l,activeKey:a})})}componentWillMount(){var e=this.props,t=e.dispatch,a=e.location,l=this.state,d=l.headlist,u=l.panes;a.hasOwnProperty("query")&&(t({type:"gdevice/queryHostDetail",payload:{id:a.query.id,cb:e=>{if(0!==Object.keys(e).length){var t=`${e.detail_id}`,a=e.fqdn;this.isInArray(d,a)||(d.push(a),u.push({information:e,key:`${t}`,title:a})),this.setState({panes:u,headlist:d,activeKey:t,projectlist:e.projectlists,hostid:this.props.location.query.id})}2==e.status.host_status_id?this.setState({haspower:!0}):this.setState({haspower:!1})}}}),t({type:"gidc/queryIdcRelation",payload:"?tag=idc"}),t({type:"gproline/getProjectLine"}),t({type:"ghardware/queryHardwarePlan"}),t({type:"gdevice/queryUser"}))}newDateChange(e,t){var a=this.props.form,l=new Date(a.getFieldValue("stop_guaratee")?a.getFieldValue("stop_guaratee"):""),d=new Date(t);"Invalid Date"!=l&&l-d>0?this.setState({dateStatus:!0}):"Invalid Date"!=l&&l-d<0&&(this.setState({dateStatus:!1}),o.default.error("Please confirm that the maintenance time is greater than the purchase time!"))}oldDateChange(e,t){var a=this.props.form,l=new Date(a.getFieldValue("start_guaratee")?a.getFieldValue("start_guaratee"):""),d=new Date(t);"Invalid Date"!=l&&d-l>0?this.setState({dateStatus:!0}):"Invalid Date"!=l&&d-l<0&&(this.setState({dateStatus:!1}),o.default.error("Please confirm that the maintenance time is greater than the purchase time!"))}render(){return console.log("projectids",R),v.default.createElement(g.default,{hideAdd:!0,onChange:this.onChange,activeKey:this.state.activeKey,type:"editable-card",onEdit:this.onEdit},this.state.panes.map(e=>v.default.createElement(S,{tab:e.title,key:e.key},this.tabcontent(e.information))))}},b=V))||b)||b);t.default=Y}}]);